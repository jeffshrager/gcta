import numpy

# original
# w_mat = [[-9.18347168, -9.27240086, -8.92519283, -8.20099926, -3.58878183
# , -18.02451515, -12.67471313, -11.94957638, -10.71409225, -19.15688515
# , -11.10240555]
# , [-12.1747551, -14.01770496, -14.46427059, -15.10067368, -21.46432877
# , -6.67121363, -10.88628387, -11.98709869, -13.90428638, -23.67790222
# , -13.49435616]
# , [-19.42021561, -17.59747314, -18.76243782, -19.97263908, -25.35348511
# , -24.11816216, -19.88859749, -19.16145134, -17.79005623, -6.8203001
# , -18.91627121]
# , [-16.25148582, -15.73608685, -13.80775261, -18.00488281, -22.50829315
# , -6.43483829, -17.85696411, -15.90418816, -14.36449718, -24.9148941
# , -14.45423985]
# , [-21.25315666, -22.06438637, -22.54598618, -17.07777405, -31.10130501
# , -29.74467087, -17.86845207, -22.21762276, -22.33332253, -28.81605148
# , -22.04460716]
# , [-15.21536446, -14.83707428, -15.40761566, -16.15569878, -3.95406938
# , -17.72766876, -15.38029194, -12.91432858, -14.67711926, -5.64475489
# , -13.57172108]]

# new alg
# w_mat = [[-11.39351368, -11.08301067, -10.86226273, -10.07893181, -6.33147287
# , -21.37499428, -15.35601711, -14.34636307, -12.80983639, -26.30672455
# , -13.38997936]
# , [-16.24057198, -18.45527649, -18.81697273, -19.97370911, -28.32909966
# , -10.32458878, -14.5200758, -15.76032162, -17.91260338, -31.35109711
# , -17.53386307]
# , [-24.3283844, -21.79932976, -23.12822342, -24.39302063, -29.36969185
# , -30.3417778, -24.92523575, -23.81367111, -22.0158329, -8.05051804
# , -23.60589409]
# , [-19.07575226, -18.55150414, -16.40079689, -23.28380775, -26.76245308
# , -10.91045284, -22.59118271, -18.8157177, -16.93252945, -32.80857468
# , -17.17885208]
# , [-26.12126732, -26.94091415, -27.56603813, -19.87691116, -35.79546738
# , -34.4620285, -21.79374313, -26.91116905, -27.40316582, -35.57458496
# , -26.92312431]
# , [-18.61184311, -18.51116562, -19.03958511, -19.74524689, -6.02628469
# , -19.9820919, -18.64805794, -16.3403511, -18.27697182, -6.80569601
# , -16.94482994]]

# less confounded
w_mat = [[-25.68937492, -29.19758224, -30.53919983, -30.65885925, -30.77046204
, -13.18594265, -29.8954258, -31.55392265, -31.945467, -31.76343918
, -32.64898682]
, [-21.29331017, -21.18139267, -23.93740463, -25.1172657, -25.70685577
, -26.17307281, -9.85025501, -28.212183, -29.01109695, -26.19568825
, -29.56288528]
, [-20.74555588, -18.71603394, -18.83566093, -21.34742928, -22.98211479
, -27.51375008, -22.5742836, -26.48026276, -27.47839928, -7.88901711
, -24.74230766]
, [-23.15824318, -22.39604759, -19.56433868, -19.93575287, -22.84282112
, -27.44304276, -29.22505569, -25.43536377, -25.17204666, -24.85425186
, -7.79988098]
, [-24.4078598, -24.16379547, -22.88522339, -20.43366623, -20.29989815
, -27.81408501, -28.25141144, -23.93034363, -8.5105114, -27.93547058
, -25.5217495, ]
, [-30.89876747, -31.17414284, -30.46920776, -30.02213287, -25.97957993
, -31.31873131, -33.50017548, -14.80264854, -30.31479454, -33.31635284
, -32.48210526]]


backwards = {'BEVACIZUMAB': 0, 'TEMOZOLOMIDE': 1, 'CABAZITAXEL': 2, 'TCAR': 3, 'DISATINIB': 4, 'NIVOLUMAB': 5, 
                 'DOXORUBICIN': 6, 'DURVALUMAB': 7, 'PEMBROLIZUMAB': 8, 'VARLILUMAB': 9, 'SORAFENIB': 10}

drug_dict = dict((v,k) for k,v in backwards.items())

mut_dict = {0: 'MGMT-Promoter', 1: 'HLA-A2', 2: 'HLA-A1', 3: 'IDH2', 4: 'IDH1', 5: 'EGFR'}

muts = [[0, 0, 0, 0, 0, 1], [0, 0, 0, 0, 1, 0], [0, 0, 0, 1, 0, 0], [0, 0, 1, 0, 0, 0], [0, 1, 0, 0, 0, 0], [1, 0, 0, 0, 0, 0]]

preds = {}

for i in range(len(muts)):
    mut = muts[i]
    scores = list(numpy.matmul(mut, w_mat))
    # print(mut)
    print(mut_dict[i])
    print(scores)
    scores_copy = scores[:]
    scores_copy.sort()

    ranked_drugs = []
    for j in range(1, len(scores_copy)+1):
        ranked_drugs.append(scores.index(scores_copy[-j]))
    
    for k in range(len(ranked_drugs)):
        ranked_drugs[k] = drug_dict[ranked_drugs[k]]    

    print(ranked_drugs)
    print('stddev', str(numpy.std(scores)))
    print('mean', str(numpy.mean(scores)))

    preds[mut_dict[i]] = ranked_drugs

    print('====================================')